
В ходе тщательного анализа файлов расширения браузера под названием "chatgpt" была однозначно установлена его вредоносная природа.

### Статический анализ 
#### Тип и структура файла

Браузерное расширение Chrome. Состоит из нескольких файлов app.js, crypto.js, loader.js, manifest.json, ui.html.

#### Файл manifest.json

В коде файла manifest.json указаны разрешения    "tabs", "http://*/*", "https://*/*", "storage", "webRequest", "webRequestBlocking", "cookies". Это указывает на то, что расширению дается уровень доступа, который позволяет работать на всех веб-страницах, перехватывать логин/ пароль и перехватывать/ модифицировать сетевой трафик.  Кроме этого, в файле указывается фоновый скрипт для работы loader.js со значением "persistent": true.  Это означает, что фоновый скрипт никогда не выгружается. Потенциально опасным может являться контент-скрипт, так как в нем указаны значения "matches": ["<all_urls>"], "js": ["core/app.js"].  Такие значения указывают на то, что расширение может внедрять js код в любой сайт, читать dom и взаимодействовать с формами

#### Файлы javascript

Для сокрытия целевого домена используются base64 строки. Расширение использует для захвата и мониторинга нажатий клавиш пользователя клавишу `keydown`. Расширение фиксирует нажатия клавиш, регистрирует их и отправляет их для дальнейшей обработки. В этом файле также есть указания на то, что учетные данные при отправке  форм фиксируются расширением для их дальнейшей эксфильтрации.
Кроме того, найден подозрительный сетевой запрос через image. Такой подход позволяет злоумышленнику отправить украденные данные, обходя CORS систему.
#### Библиотека и структура файла 

Для заслонения целевых URL адресов используется метод кодирования base64. Найдена функция, которая преобразует данные, чтобы сделать их менее очевидными.
В файле app.js значение targets возвращает закодированную строку в формате base64, которое принимает значение www.facebook.com  после расшифровки. Это может свидетельствовать о том, что это элемент простой обфуксации, направленный на то, чтобы скрыть, что скрипт работает только на www.facebook.com
#### Обфуксация и сигнатуры

В коде применяется обфуксация данных и шифрование. Анализ показал наличие функций, которые служат для запутывания читаемости кода. Также обнаружена поведенческая обфуксация - маскировка сетевого запроса, что может указывать на то,что вредоносный трафик замаскирован. Была замечена обфуксация на уровне данных, которая была представлена в виде AES-шифрование с предустановленным ключом.
1. Which encoding method does the browser extension use to obscure target URLs, making them more difficult to detect during analysis?
![[Pasted image 20250721124307.png]]
![[Pasted image 20250721124512.png]]
2. Which website does the extension monitor for data theft, targeting user accounts to steal sensitive information?
www.facebook.com
3.  Which type of HTML element is utilized by the extension to send stolen data?

Злоумышленник реализовал передачу зашифрованной информации (включающей, в частности, учетные данные и нажатия клавиш) путём создания элемента изображения в DOM. В качестве значения атрибута src элемента img указана ссылка на внешний ресурс с параметром data, в который инкапсулируется зашифрованная полезная нагрузка.
Браузер, интерпретируя этот элемент как стандартный запрос на загрузку изображения, автоматически инициирует HTTP GET-запрос по указанному адресу. Тем самым данные передаются на контролируемый злоумышленником сервер, минуя стандартные механизмы защиты и обнаружения.
![[Pasted image 20250721124626.png]]
4.  What is the first specific condition in the code that triggers the extension to deactivate itself?
В ходе статического анализа файла loader.js, входящего в состав расширения, была выявлена реализация механизма анти-анализа, направленного на деактивацию вредоносной функциональности при обнаружении признаков запуска в контролируемой или эмулированной среде (например, в виртуальных машинах, песочницах, headless-браузерах и т.п.). Первым конкретным условием, которое вызывает деактивацию расширения, является строка 
if (navigator.plugins.length === 0 || /HeadlessChrome/.test(navigator.userAgent))
![[Pasted image 20250721124742.png]]
5.  Which event does the extension capture to track user input submitted through forms?
В результате анализа содержимого файла `app.js`, входящего в состав расширения, выявлен механизм слежения за действиями пользователя, направленный на перехват чувствительной информации, вводимой в веб-формы.
Данный механизм позволяет злоумышленнику:
Получать данные учетных записей, включая логины и пароли, без ведома пользователя;
![[Pasted image 20250721125056.png]]
6.  Which API or method does the extension use to capture and monitor user keystrokes?
В ходе анализа кода app.js, входящего в состав расширения, установлено, что используется механизм мониторинга нажатий клавиш (кейлоггинга). Данная функция позволяет злоумышленнику в реальном времени отслеживать клавиатурную активность пользователя и собирать потенциально чувствительные данные (например, логины, пароли, сообщения и др.). Данный механизм позволяет злоумышленнику: в реальном времени фиксировать все клавиатурные действия пользователя;
![[Pasted image 20250721125145.png]]

7.  What is the domain where the extension transmits the exfiltrated data?
Передача данных осуществляется через функцию sendToServer. К URL-адресу https://Mo.Elshaheedy.com/collect добавляется параметр data, содержащий зашифрованные данные.
![[Pasted image 20250721125251.png]]
8.  Which function in the code is used to exfiltrate user credentials, including the username and password?
В ходе статического анализа файла app.js, входящего в состав расширения, была идентифицирована функция exfiltrateCredentials, предназначенная для сбора, шифрования и передачи учетных данных пользователей на удаленный сервер.
Наличие данной функции свидетельствует о целенаправленном характере вредоносной активности, направленной на  кражу учетных данных пользователей;
![[Pasted image 20250721125338.png]]
9.  Which encryption algorithm is applied to secure the data before sending?
В ходе анализа вредоносного расширения было установлено, что передача похищенных данных на удаленный сервер предварительно сопровождается процессом шифрования. Шифрование осуществляется в функции encryptPayload, расположенной в файле app.js, с использованием алгоритма AES (Advanced Encryption Standard) через библиотеку CryptoJS.
Применение стандарта AES указывает на осознанную попытку злоумышленников скрыть содержимое похищаемых данных.
![[Pasted image 20250721125421.png]]
10.  What does the extension access to store or manipulate session-related data and authentication information?
В ходе анализа функционала расширения было выявлено, что расширение обладает доступом к API cookies, что позволяет ему сохранять, считывать и изменять данные, связанные с сессиями пользователя и информацией об аутентификации.
Cookies часто используются для хранения токенов сессии и других чувствительных данных, обеспечивающих идентификацию пользователя на различных веб-сайтах. Доступ расширения к API cookies предоставляет ему возможность перехватывать и модифицировать эти данные. В результате злоумышленник, получивший контроль над расширением, может осуществить захват пользовательских сессий (session hijacking) или получить доступ к токенам аутентификации.
Данное поведение представляет собой значительную угрозу безопасности, так как расширение получает расширенные права управления сессионными данными. Это повышает риск компрометации учетных записей пользователей и дальнейшей эксплуатации уязвимостей.
![[Pasted image 20250721125516.png]]